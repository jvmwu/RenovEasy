# 需求文档

## 介绍

本功能为家庭装修接单App添加完整的身份认证系统，支持用户端和装修工端的注册/登录。系统将提供多种认证方式，包括手机号短信验证、密码登录，以及社交账号登录（Google、Apple Sign In、Facebook），确保用户使用的便利性和安全性。

## 需求

### 需求 1

**用户故事：** 作为新用户（需要装修的用户或装修工），我希望使用手机号注册账户，以便能够访问应用服务并维护个人资料。

#### 验收标准

1. 当用户首次打开应用时，系统应显示身份认证界面
2. 当用户输入有效手机号时，系统应发送短信验证码
3. 当用户输入正确验证码时，系统应创建新账户并进入用户类型选择
4. 如果手机号已注册，系统应重定向到登录流程
5. 当账户创建成功时，系统应安全存储用户凭据

### 需求 2

**用户故事：** 作为已注册用户，我希望使用手机号和短信验证码或密码登录，以便快速访问我的账户。

#### 验收标准

1. 当用户输入已注册手机号时，系统应提供短信验证和密码登录两种选项
2. 当用户选择短信验证时，系统应发送验证码并进行验证
3. 当用户选择密码登录时，系统应验证密码与存储凭据的匹配性
4. 如果登录凭据无效，系统应显示相应的错误信息
5. 当登录成功时，系统应重定向到相应的主页面（用户端或装修工端）

### 需求 3

**用户故事：** 作为用户，我希望使用社交账号（Google、Apple Sign In、Facebook）注册/登录，以便使用现有凭据而无需创建新密码。

#### 验收标准

1. 当用户点击社交登录按钮时，系统应启动与所选提供商的OAuth流程
2. 当社交认证成功时，系统应获取用户资料信息
3. 如果社交账号未关联到现有账户，系统应创建新账户
4. 当社交账号创建成功时，系统应将社交账号关联到用户资料
5. 如果社交账号已关联，系统应直接登录用户

### 需求 4

**用户故事：** 作为新用户，我希望在注册时选择是否为装修工，以便访问相应的界面和功能。

#### 验收标准

1. 当新用户完成手机验证时，系统应询问用户是否为装修工
2. 当用户选择"不是装修工"时，系统应配置账户为普通用户功能
3. 当用户选择"我是装修工"时，系统应配置账户为装修工功能并要求额外验证
4. 当选择账户类型时，系统应进入相应类型的资料设置
5. 如果选择装修工账户，系统应要求提供专业认证文件

### 需求 5

**用户故事：** 作为用户，我希望使用手机号重置密码或恢复账户，以便在忘记凭据时重新获得访问权限。

#### 验收标准

1. 当用户点击"忘记密码"时，系统应显示手机号输入界面进行恢复
2. 当输入有效的已注册手机号时，系统应发送恢复短信验证码
3. 当恢复验证码验证通过时，系统应允许重置密码
4. 当设置新密码时，系统应更新存储的凭据
5. 当密码重置完成时，系统应自动登录用户

### 需求 6

**用户故事：** 作为用户，我希望登录会话在应用启动间保持，以便不需要重复登录。

#### 验收标准

1. 当用户成功登录时，系统应存储安全的会话令牌
2. 当应用启动且存在有效会话时，系统应自动认证用户
3. 当会话过期时，系统应重定向到登录界面
4. 当用户登出时，系统应清除所有会话数据
5. 如果生物识别认证可用，系统应提供生物识别登录选项

### 需求 7

**用户故事：** 作为用户，我希望在认证过程中获得清晰的视觉反馈，以便了解正在发生的事情并能够排除问题。

#### 验收标准

1. 当认证进行中时，系统应显示加载指示器
2. 当短信发送中时，系统应显示发送状态和倒计时器
3. 当发生错误时，系统应显示具体的、可操作的错误信息
4. 当验证成功时，系统应显示成功确认
5. 当网络问题发生时，系统应提供重试选项

### 需求 8

**用户故事：** 作为用户，我希望认证界面遵循应用的设计系统，以便体验保持一致和熟悉。

#### 验收标准

1. 当显示认证界面时，应使用已建立的设计系统颜色、字体和间距
2. 当渲染按钮和输入框时，应遵循iOS人机界面指南
3. 当使用动画时，应与应用模式保持流畅和一致
4. 当界面适配iPhone 16 Pro时，应尊重安全区域和设备规格
5. 当需要无障碍功能时，界面应支持VoiceOver和动态文本大小调整